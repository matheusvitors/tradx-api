// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model Usuario {
    id        Int      @id @default(autoincrement())
    publicId  String   @unique
    nome      String
    username  String   @unique
    password  String
    email     String   @unique
    Conta     Conta[]
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Conta {
    id           Int        @id @default(autoincrement())
    publicId     String     @unique
    nome         String
    tipo         String
    usuario      Usuario    @relation(fields: [usuarioId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    usuarioId    Int
    saldo        Decimal    @default(0.00) @db.Decimal(15, 2)
    saldoInicial Decimal    @default(0.00) @db.Decimal(15, 2)
    Operacao     Operacao[]
    createdAt    DateTime   @default(now())
    updatedAt    DateTime   @updatedAt
}

model Ativo {
    id             Int        @id @default(autoincrement())
    publicId       String     @unique
    nome           String
    acronimo       String     @unique
    tipo           String
    multiplicador  Decimal    @default(1.00) @db.Decimal(7, 2)
    dataVencimento DateTime?
    Operacao       Operacao[]
    createdAt      DateTime   @default(now())
    updatedAt      DateTime   @updatedAt
}

model Operacao {
    id              String    @id @unique
    ativo           Ativo     @relation(fields: [ativoId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    ativoId         Int
    conta           Conta     @relation(fields: [contaId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    contaId         Int
    quantidade      Int
    tipo            String
    precoEntrada    Int
    stopLoss        Int
    alvo            Int
    precoSaida      Int?
    dataEntrada     DateTime
    dataSaida       DateTime?
    margem          Decimal?
    operacaoPerdida Boolean
    operacaoErrada  Boolean
    motivo          String?
    comentarios     String?
    createdAt       DateTime  @default(now())
    updatedAt       DateTime  @updatedAt
}
